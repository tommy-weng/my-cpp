# DHT20温湿度传感器lxpanel插件

这个插件将DHT20温湿度传感器适配为lxpanel插件，可以在面板上实时显示温度和湿度数据。

## 安装和测试

### 1. 重启lxpanel
插件已安装，但需要重启lxpanel使其生效。您可以选择以下方式之一：

- 重启整个系统：
  ```bash
  sudo reboot
  ```

- 或者仅重启lxpanel（需要先找到lxpanel的进程ID）：
  ```bash
  ps aux | grep lxpanel
  # 找到lxpanel的进程ID（PID），然后执行：
  kill -HUP <PID>
  ```

### 2. 添加插件到面板
重启lxpanel后，按照以下步骤添加插件：

1. 右键点击lxpanel的空白区域
2. 选择"面板设置"或"添加/删除面板项"
3. 在插件列表中找到"DHT20温湿度传感器"
4. 点击"添加"按钮将其添加到面板
5. 点击"关闭"完成设置

### 3. 验证插件功能
插件添加成功后，您应该能在面板上看到：
- 初始显示"初始化中..."
- 几秒后开始显示实时的温度和湿度数据，格式为："温度: XX.X°C 湿度: XX.X%"

如果显示"I2C初始化失败"，请检查：
- DHT20传感器是否正确连接到I2C总线
- I2C地址是否为0x38
- 是否启用了I2C接口

如果显示"传感器读取失败"，请检查：
- 传感器连接是否正常
- I2C总线是否正常工作

## 文件说明
- `dht20_plugin.c` - 插件源代码
- `dth_sensor.c` - 原始DHT20传感器读取代码
- `Makefile` - 编译配置文件
- `dht20.so` - 编译后的插件文件（自动生成）

## 技术细节
- 插件每2秒更新一次温湿度数据
- 使用wiringPi库进行I2C通信
- 支持lxpanel插件标准接口
- 错误处理和资源管理已实现

## 故障排除
如果遇到问题，请检查：
1. I2C接口是否已启用（使用`raspi-config`工具）
2. DHT20传感器是否正确连接（SDA、SCL、VCC、GND）
3. 是否有其他I2C设备地址冲突
4. 系统日志中是否有相关错误信息